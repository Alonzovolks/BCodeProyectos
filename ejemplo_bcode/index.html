<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perú: Muchas Culturas, Un Solo Corazón</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'peru-blue': '#1a365d',
                        'peru-red': '#d90429',
                        'peru-yellow': '#f9c80e',
                        'peru-green': '#2a9d8f',
                        'peru-purple': '#6a4c93'
                    },
                    fontFamily: {
                        'nunito': ['Nunito', 'sans-serif'],
                        'comic': ['Comic Neue', 'cursive']
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Comic Neue', cursive;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23f0f9ff"/><path d="M20,20 Q40,5 60,20 T100,20 L100,80 Q80,95 60,80 T20,80 Z" fill="%23e6f7ff" opacity="0.6"/></svg>');
            min-height: 100vh;
        }
        .character {
            transition: transform 0.3s ease;
        }
        .character:hover {
            transform: scale(1.05) rotate(5deg);
        }
        .mission-card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            overflow: hidden;
        }
        .mission-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        .puzzle-piece {
            cursor: move;
            transition: transform 0.2s;
        }
        .puzzle-piece:hover {
            transform: scale(1.03);
        }
        .droppable {
            background-color: rgba(42, 157, 143, 0.1);
            border: 2px dashed #2a9d8f;
        }
        .word-search-cell {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .word-search-cell.selected {
            background-color: #f9c80e;
        }
        .word-search-cell.found {
            background-color: #2a9d8f;
            color: white;
        }
        .progress-bar {
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2a9d8f 0%, #f9c80e 100%);
            transition: width 0.5s ease;
        }
        .badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .bounce {
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .dragging {
            opacity: 0.7;
            transform: scale(1.1);
        }
        .success {
            animation: success 0.5s;
        }
        @keyframes success {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .puzzle-container {
            perspective: 1000px;
        }
        .puzzle-slot {
            background-color: rgba(249, 200, 14, 0.1);
            border: 2px dashed #f9c80e;
        }
        .shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .pulse {
            animation: pulse 1.5s infinite;
        }
        .fade-out {
            animation: fadeOut 0.5s ease-out forwards;
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; transform: translateY(20px); }
        }
        .zoom-in {
            animation: zoomIn 0.3s ease-out;
        }
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f9c80e;
            border-radius: 50%;
            animation: confetti-fall 5s linear forwards;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <header class="bg-gradient-to-r from-peru-blue to-peru-red text-white py-4 px-6 shadow-lg">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center mb-4 md:mb-0">
                <div class="bg-white p-2 rounded-full">
                    <div class="bg-gradient-to-r from-peru-red to-peru-yellow w-10 h-10 rounded-full flex items-center justify-center">
                        <i class="fas fa-heart text-white text-xl"></i>
                    </div>
                </div>
                <div class="ml-4">
                    <h1 class="text-2xl md:text-3xl font-bold">Perú: Muchas Culturas, Un Solo Corazón</h1>
                    <p class="text-yellow-300">Guardianes de la Convivencia</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-center">
                    <p class="text-sm">Puntos</p>
                    <div class="text-xl font-bold text-peru-yellow"><span id="points-counter">125</span></div>
                </div>
                <div class="relative">
                    <div class="badge bg-peru-yellow text-peru-blue w-12 h-12 rounded-full flex items-center justify-center">
                        <i class="fas fa-shield-alt text-2xl"></i>
                    </div>
                </div>
                <button id="user-menu" class="bg-peru-green text-white px-4 py-2 rounded-full flex items-center">
                    <i class="fas fa-user mr-2"></i>
                    <span id="username">Estudiante</span>
                </button>
            </div>
        </div>
    </header>

    <div id="user-menu-dropdown" class="hidden absolute right-4 mt-2 w-48 bg-white rounded-md shadow-lg z-10">
        <div class="py-1">
            <button id="profile-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-user-circle mr-2"></i> Perfil
            </button>
            <button id="admin-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-cog mr-2"></i> Panel Admin
            </button>
            <button id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                <i class="fas fa-sign-out-alt mr-2"></i> Cerrar Sesión
            </button>
        </div>
    </div>

    <div class="container mx-auto px-4 py-2">
        <div class="bg-white rounded-full shadow p-1">
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 35%;"></div>
            </div>
        </div>
        <div class="flex justify-between text-sm mt-1">
            <span>Misión 1</span>
            <span>Misión 2</span>
            <span>Misión 3</span>
        </div>
    </div>

    <main class="container mx-auto px-4 py-8">
        <section id="welcome" class="mb-12 text-center fade-in">
            <div class="relative mb-8">
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-peru-yellow text-peru-blue px-6 py-2 rounded-full font-bold">
                    ¡Bienvenido, Guardián!
                </div>
                <div class="bg-white p-8 rounded-xl shadow-lg pt-16">
                    <p class="text-xl mb-6">
                        <i class="fas fa-globe-americas text-peru-green text-3xl bounce inline-block mb-4"></i>
                    </p>
                    <p class="text-xl mb-6">
                        Junto a Dora, Camila y Alex, emprenderemos un viaje por el Perú para aprender sobre respeto, diversidad cultural y convivencia democrática. 
                    </p>
                    <p class="text-xl mb-6">
                        Tu misión es superar tres desafíos para obtener el <span class="font-bold text-peru-yellow">Gran Escudo de la Democracia Intercultural</span>.
                    </p>
                    <p class="text-xl font-bold text-peru-red">
                        ¿Estás listo para la aventura?
                    </p>
                </div>
            </div>
            
            <div class="flex flex-wrap justify-center gap-8 mb-10">
                <div class="character">
                    <div class="bg-white p-4 rounded-xl shadow-lg w-48 transform transition hover:rotate-3">
                        <div class="bg-gradient-to-b from-yellow-200 to-yellow-400 w-16 h-16 rounded-full mx-auto mb-2 flex items-center justify-center">
                            <i class="fas fa-compass text-white text-2xl"></i>
                        </div>
                        <h3 class="font-bold text-lg">Dora la Exploradora</h3>
                        <p class="text-sm">Tu guía en esta aventura</p>
                    </div>
                </div>
                <div class="character">
                    <div class="bg-white p-4 rounded-xl shadow-lg w-48 transform transition hover:-rotate-3">
                        <div class="bg-gradient-to-b from-green-200 to-green-500 w-16 h-16 rounded-full mx-auto mb-2 flex items-center justify-center">
                            <i class="fas fa-mountain text-white text-2xl"></i>
                        </div>
                        <h3 class="font-bold text-lg">Camila</h3>
                        <p class="text-sm">De los Andes</p>
                    </div>
                </div>
                <div class="character">
                    <div class="bg-white p-4 rounded-xl shadow-lg w-48 transform transition hover:rotate-3">
                        <div class="bg-gradient-to-b from-blue-200 to-blue-500 w-16 h-16 rounded-full mx-auto mb-2 flex items-center justify-center">
                            <i class="fas fa-water text-white text-2xl"></i>
                        </div>
                        <h3 class="font-bold text-lg">Alex</h3>
                        <p class="text-sm">De la costa</p>
                    </div>
                </div>
            </div>
            
            <button id="start-btn" class="bg-gradient-to-r from-peru-green to-peru-blue text-white font-bold py-4 px-10 rounded-full text-xl transition duration-300 transform hover:scale-105 shadow-lg">
                ¡Comenzar Aventura! <i class="fas fa-arrow-right ml-2"></i>
            </button>
        </section>

        <section id="mission1" class="hidden mb-12">
            <div class="text-center mb-8">
                <div class="inline-block bg-peru-blue text-white px-6 py-2 rounded-full mb-4">
                    <h2 class="text-2xl font-bold">Misión 1: Convivimos sin excluir</h2>
                </div>
                <p class="text-xl max-w-3xl mx-auto">Identifica normas básicas de convivencia y valora la diversidad en nuestro país.</p>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-blue text-white p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-video mr-2"></i> Video Educativo
                    </h3>
                    <div class="bg-peru-yellow text-peru-blue px-3 py-1 rounded-full text-sm font-bold">
                        +10 puntos
                    </div>
                </div>
                <div class="p-4">
                    <p class="mb-4">Mira este video sobre la discriminación y piensa en cómo podemos evitarla:</p>
                    <div class="bg-gray-800 aspect-video flex items-center justify-center rounded-lg relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-purple-800 to-indigo-900 opacity-80"></div>
                        <div class="relative z-10 text-white text-center p-4">
                            <i class="fas fa-play-circle text-5xl mb-2 text-peru-yellow"></i>
                            <h4 class="text-2xl font-bold mb-2">¿Qué es la discriminación?</h4>
                            <p class="max-w-md mx-auto">Aprenderemos juntos sobre el respeto y la inclusión en nuestra sociedad</p>
                        </div>
                    </div>
                    <div class="mt-4">
                        <button id="video-complete" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            <i class="fas fa-check-circle mr-2"></i> He visto el video
                        </button>
                    </div>
                </div>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-blue text-white p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-question-circle mr-2"></i> Juego de Preguntas
                    </h3>
                    <div class="bg-peru-yellow text-peru-blue px-3 py-1 rounded-full text-sm font-bold">
                        +20 puntos
                    </div>
                </div>
                <div class="p-4">
                    <div id="quiz-container">
                        <p class="mb-4">Responde correctamente estas preguntas sobre convivencia y respeto:</p>
                        
                        <div id="quiz-questions" class="space-y-6">
                        </div>
                        
                        <div class="mt-6">
                            <button id="check-quiz" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                                Verificar respuestas
                            </button>
                            <p id="quiz-result" class="mt-4 font-bold text-lg hidden"></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-blue text-white p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-puzzle-piece mr-2"></i> Rompecabezas Digital
                    </h3>
                    <div class="bg-peru-yellow text-peru-blue px-3 py-1 rounded-full text-sm font-bold">
                        +15 puntos
                    </div>
                </div>
                <div class="p-4">
                    <p class="mb-4">Arma este rompecabezas que muestra niños jugando juntos:</p>
                    
                    <div class="flex flex-col md:flex-row gap-6 items-center">
                        <div class="w-full md:w-1/2">
                            <h4 class="font-bold mb-2">Piezas del rompecabezas:</h4>
                            <div class="grid grid-cols-3 gap-2 mb-4" id="puzzle-pieces-container">
                            </div>
                        </div>
                        
                        <div class="w-full md:w-1/2">
                            <h4 class="font-bold mb-2">Tablero:</h4>
                            <div class="grid grid-cols-3 gap-2" id="puzzle-board">
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 text-center">
                        <button id="check-puzzle" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            Verificar rompecabezas
                        </button>
                        <button id="reset-puzzle" class="bg-peru-red text-white py-2 px-6 rounded-lg ml-2">
                            Reiniciar
                        </button>
                        <p id="puzzle-result" class="mt-4 font-bold text-lg hidden"></p>
                    </div>
                </div>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-blue text-white p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-lightbulb mr-2"></i> Adivinanza
                    </h3>
                    <div class="bg-peru-yellow text-peru-blue px-3 py-1 rounded-full text-sm font-bold">
                        +10 puntos
                    </div>
                </div>
                <div class="p-4">
                    <div class="bg-yellow-100 p-6 rounded-lg text-center mb-4">
                        <p class="text-xl font-bold italic mb-4">"Sin gritar ni empujar, yo dejo a todos jugar. ¿Quién soy?"</p>
                        <div class="flex justify-center">
                            <input type="text" id="riddle-answer" placeholder="Escribe tu respuesta" class="px-4 py-2 rounded-l-lg border-2 border-peru-yellow w-64 focus:outline-none focus:ring-2 focus:ring-peru-yellow">
                            <button id="check-riddle" class="bg-peru-yellow text-peru-blue px-4 py-2 rounded-r-lg font-bold hover:bg-yellow-500">
                                Comprobar
                            </button>
                        </div>
                        <p id="riddle-result" class="mt-4 font-bold hidden"></p>
                    </div>
                    <div class="text-center">
                        <button id="save-mission1" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            <i class="fas fa-save mr-2"></i> Guardar misión
                        </button>
                        <button id="next-mission2" class="bg-peru-blue text-white py-2 px-6 rounded-lg ml-4">
                            Siguiente misión <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="mission2" class="hidden mb-12">
            <div class="text-center mb-8">
                <div class="inline-block bg-peru-green text-white px-6 py-2 rounded-full mb-4">
                    <h2 class="text-2xl font-bold">Misión 2: Historias que enseñan</h2>
                </div>
                <p class="text-xl max-w-3xl mx-auto">Reflexiona sobre situaciones de inclusión y exclusión en nuestra sociedad.</p>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-green text-white p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-images mr-2"></i> Observa y Reflexiona
                    </h3>
                    <div class="bg-peru-yellow text-peru-blue px-3 py-1 rounded-full text-sm font-bold">
                        +20 puntos
                    </div>
                </div>
                <div class="p-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="border-2 border-red-300 rounded-lg p-4 bg-red-50">
                            <div class="bg-gradient-to-br from-red-200 to-red-400 rounded-xl w-full h-48 mb-4 flex items-center justify-center">
                                <i class="fas fa-user-slash text-white text-6xl"></i>
                            </div>
                            <h4 class="font-bold text-red-600 mb-2">Situación de Exclusión</h4>
                            <p>Un niño no es invitado a jugar por hablar quechua.</p>
                            <div class="mt-4 space-y-2">
                                <textarea placeholder="¿Qué pasó en esta situación?" class="w-full p-2 rounded border border-red-300"></textarea>
                                <textarea placeholder="¿Cómo crees que se sintió el niño?" class="w-full p-2 rounded border border-red-300"></textarea>
                                <textarea placeholder="¿Cómo se podría mejorar esta situación?" class="w-full p-2 rounded border border-red-300"></textarea>
                            </div>
                        </div>
                        <div class="border-2 border-green-300 rounded-lg p-4 bg-green-50">
                            <div class="bg-gradient-to-br from-green-200 to-green-400 rounded-xl w-full h-48 mb-4 flex items-center justify-center">
                                <i class="fas fa-user-friends text-white text-6xl"></i>
                            </div>
                            <h4 class="font-bold text-green-600 mb-2">Situación de Inclusión</h4>
                            <p>Una niña es aceptada por su grupo a pesar de sus diferencias.</p>
                            <div class="mt-4 space-y-2">
                                <textarea placeholder="¿Qué pasó en esta situación?" class="w-full p-2 rounded border border-green-300"></textarea>
                                <textarea placeholder="¿Cómo crees que se sintió la niña?" class="w-full p-2 rounded border border-green-300"></textarea>
                                <textarea placeholder="¿Qué podemos aprender de esto?" class="w-full p-2 rounded border border-green-300"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-6">
                        <button class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            <i class="fas fa-save mr-2"></i> Guardar reflexiones
                        </button>
                    </div>
                </div>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-green text-white p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-paint-brush mr-2"></i> Mural Digital
                    </h3>
                    <div class="bg-peru-yellow text-peru-blue px-3 py-1 rounded-full text-sm font-bold">
                        +15 puntos
                    </div>
                </div>
                <div class="p-4">
                    <p class="mb-4">Crea un mural digital con mensajes de inclusión:</p>
                    
                    <div class="bg-white border-2 border-dashed border-peru-green rounded-lg min-h-[300px] p-4 mb-4" id="mural-container">
                        <div id="mural-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-bold mb-2">Añade tu mensaje:</h4>
                        <div class="flex flex-col md:flex-row gap-2">
                            <input type="text" id="mural-message" placeholder="Escribe tu mensaje de inclusión" class="flex-grow p-3 rounded-lg border-2 border-peru-blue focus:outline-none focus:ring-2 focus:ring-peru-blue">
                            <button id="add-mural-message" class="bg-peru-blue text-white py-3 px-6 rounded-lg hover:bg-blue-800">
                                Añadir al mural
                            </button>
                        </div>
                    </div>
                    
                    <div class="text-center mt-6">
                        <button id="save-mission2" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            <i class="fas fa-save mr-2"></i> Guardar misión
                        </button>
                        <button id="next-mission3" class="bg-peru-blue text-white py-2 px-6 rounded-lg ml-4">
                            Siguiente misión <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="mission3" class="hidden mb-12">
            <div class="text-center mb-8">
                <div class="inline-block bg-peru-yellow text-peru-blue px-6 py-2 rounded-full mb-4">
                    <h2 class="text-2xl font-bold">Misión 3: Compromisos que transforman</h2>
                </div>
                <p class="text-xl max-w-3xl mx-auto">Promueve acciones concretas para evitar la exclusión en tu entorno.</p>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-yellow text-peru-blue p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-users mr-2"></i> Cartel Colaborativo
                    </h3>
                    <div class="bg-peru-red text-white px-3 py-1 rounded-full text-sm font-bold">
                        +20 puntos
                    </div>
                </div>
                <div class="p-4">
                    <div class="bg-red-100 border-2 border-peru-red rounded-lg p-6 text-center mb-6">
                        <h3 class="text-2xl font-bold text-peru-red mb-4">"En nuestra aula nadie queda fuera"</h3>
                        <div class="flex flex-wrap justify-center gap-4" id="commitments-container">
                        </div>
                    </div>
                    
                    <div class="mb-6 bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-bold mb-2">Añade tu compromiso:</h4>
                        <div class="flex flex-col md:flex-row gap-2">
                            <input type="text" id="commitment-text" placeholder="Escribe tu compromiso..." class="flex-grow p-3 rounded-lg border-2 border-peru-blue focus:outline-none focus:ring-2 focus:ring-peru-blue">
                            <button id="add-commitment" class="bg-peru-blue text-white py-3 px-6 rounded-lg hover:bg-blue-800">
                                Añadir compromiso
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mission-card bg-white mb-8">
                <div class="bg-peru-yellow text-peru-blue p-4 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center">
                        <i class="fas fa-font mr-2"></i> Sopa de Letras
                    </h3>
                    <div class="bg-peru-red text-white px-3 py-1 rounded-full text-sm font-bold">
                        +25 puntos
                    </div>
                </div>
                <div class="p-4">
                    <p class="mb-4">Encuentra las palabras relacionadas con la convivencia:</p>
                    
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-2 mb-4" id="word-list">
                        </div>
                    </div>
                    
                    <div class="overflow-auto">
                        <div class="inline-block bg-gray-800 p-4 rounded-lg">
                            <table class="word-search" id="word-search-table">
                            </table>
                        </div>
                    </div>
                    
                    <div class="mt-6 text-center">
                        <button id="check-word-search" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            Verificar palabras
                        </button>
                        <button id="complete-adventure" class="bg-peru-yellow text-peru-blue py-2 px-6 rounded-lg ml-4">
                            Completar aventura
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="final" class="hidden text-center py-12">
            <div class="max-w-2xl mx-auto">
                <div class="floating inline-block mb-8">
                    <div class="bg-gradient-to-r from-yellow-400 to-yellow-200 w-48 h-48 rounded-full flex items-center justify-center shadow-lg">
                        <i class="fas fa-shield-alt text-6xl text-peru-blue"></i>
                    </div>
                </div>
                
                <h2 class="text-4xl font-bold text-peru-blue mb-6">¡Felicidades, Guardián!</h2>
                
                <div class="bg-white p-8 rounded-xl shadow-lg mb-8">
                    <p class="text-xl mb-6">
                        Has completado todas las misiones y demostrado ser un verdadero Guardián de la Convivencia.
                    </p>
                    <p class="text-xl mb-6">
                        Por tu compromiso con la diversidad cultural y la convivencia democrática, te otorgamos el <span class="font-bold text-peru-yellow">Gran Escudo de la Democracia Intercultural</span>.
                    </p>
                    <p class="text-xl">
                        Recuerda llevar estos valores a tu aula, tu hogar y tu comunidad.
                    </p>
                </div>
                
                <div class="flex flex-col md:flex-row justify-center gap-6">
                    <button class="bg-peru-blue text-white py-3 px-8 rounded-full text-lg mb-4 md:mb-0">
                        <i class="fas fa-print mr-2"></i> Imprimir certificado
                    </button>
                    <button id="show-metacognition" class="bg-peru-green text-white py-3 px-8 rounded-full text-lg">
                        Reflexionar <i class="fas fa-brain ml-2"></i>
                    </button>
                </div>
            </div>
        </section>

        <section id="metacognition" class="hidden bg-blue-50 py-12 px-4">
            <div class="max-w-3xl mx-auto">
                <h2 class="text-3xl font-bold text-peru-blue text-center mb-8">Reflexión Final</h2>
                
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-question-circle text-peru-blue mr-2"></i>
                        ¿Qué aprendiste hoy que puedes aplicar en tu aula o casa?
                    </h3>
                    <textarea class="w-full p-4 rounded-lg border-2 border-blue-200 min-h-[100px] focus:outline-none focus:ring-2 focus:ring-blue-300" placeholder="Escribe tu respuesta aquí..."></textarea>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-heart text-peru-red mr-2"></i>
                        ¿Cómo te sentirías si fueras excluido por tus costumbres?
                    </h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <button class="bg-gray-100 hover:bg-gray-200 p-4 rounded-lg transition">Triste</button>
                        <button class="bg-gray-100 hover:bg-gray-200 p-4 rounded-lg transition">Solo</button>
                        <button class="bg-gray-100 hover:bg-gray-200 p-4 rounded-lg transition">Enojado</button>
                        <button class="bg-gray-100 hover:bg-gray-200 p-4 rounded-lg transition">Confundido</button>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-hands-helping text-peru-green mr-2"></i>
                        ¿Qué harás diferente para que todos se sientan parte del grupo?
                    </h3>
                    <textarea class="w-full p-4 rounded-lg border-2 border-green-200 min-h-[100px] focus:outline-none focus:ring-2 focus:ring-green-300" placeholder="Escribe tus acciones aquí..."></textarea>
                </div>
                
                <div class="text-center mt-8">
                    <button class="bg-peru-blue text-white py-3 px-8 rounded-full text-lg">
                        Guardar reflexiones
                    </button>
                </div>
            </div>
        </section>

        <section id="admin-panel" class="hidden bg-gray-100 py-12 px-4">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-peru-blue text-center mb-8">Panel de Administración</h2>
                
                <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-users-cog text-peru-purple mr-2"></i>
                        Gestión de Estudiantes
                    </h3>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white">
                            <thead>
                                <tr class="bg-peru-blue text-white">
                                    <th class="py-2 px-4 text-left">Nombre</th>
                                    <th class="py-2 px-4 text-left">Progreso</th>
                                    <th class="py-2 px-4 text-left">Puntos</th>
                                    <th class="py-2 px-4 text-left">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="students-list">
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-6">
                        <button id="add-student-btn" class="bg-peru-green text-white py-2 px-6 rounded-lg">
                            <i class="fas fa-plus mr-2"></i> Añadir Estudiante
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-tasks text-peru-green mr-2"></i>
                        Gestión de Actividades
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-bold text-peru-blue mb-2">Misión 1</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span>Video Educativo</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Juego de Preguntas</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Rompecabezas</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-bold text-peru-green mb-2">Misión 2</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span>Observa y Reflexiona</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Mural Digital</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h4 class="font-bold text-peru-yellow mb-2">Misión 3</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span>Cartel Colaborativo</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Sopa de Letras</span>
                                    <span class="bg-peru-yellow text-peru-blue px-2 rounded">Activo</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button class="bg-peru-blue text-white py-2 px-6 rounded-lg">
                            <i class="fas fa-save mr-2"></i> Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>


    <script>
        let appState = {
            currentUser: {
                id: 1,
                name: "Estudiante",
                points: 125,
                progress: 35,
                completedMissions: [1]
            },
            students: [
                { id: 1, name: "María López", points: 180, progress: 65 },
                { id: 2, name: "Juan Pérez", points: 150, progress: 55 },
                { id: 3, name: "Carlos Ramírez", points: 210, progress: 80 }
            ],
            quizData: [
                {
                    question: "¿Cuál es una norma importante para convivir en el aula?",
                    options: [
                        "Escuchar cuando otros hablan",
                        "Hablar siempre primero",
                        "Ignorar a los que son diferentes"
                    ],
                    correct: 0
                },
                {
                    question: "¿Qué debemos hacer si vemos a alguien siendo excluido?",
                    options: [
                        "Ignorar la situación",
                        "Sumarnos a la exclusión",
                        "Defender a la persona e incluirla"
                    ],
                    correct: 2
                },
                {
                    question: "¿Por qué es importante respetar las diferencias culturales?",
                    options: [
                        "Porque todos somos iguales",
                        "Porque nos hace una sociedad más fuerte",
                        "Porque es obligatorio"
                    ],
                    correct: 1
                }
            ],
            muralMessages: [
                { id: 1, text: "Todos merecemos respeto", author: "María" },
                { id: 2, text: "La diversidad nos hace fuertes", author: "Juan" },
                { id: 3, text: "Incluyamos a todos", author: "Pedro" }
            ],
            commitments: [
                { id: 1, text: "Respetar todas las opiniones" },
                { id: 2, text: "Incluir a todos en los juegos" },
                { id: 3, text: "Valorar las diferencias" },
                { id: 4, text: "Escuchar con atención" }
            ],
            wordSearchWords: ["RESPETO", "INCLUSION", "DIVERSIDAD", "IGUALDAD", "SOLIDARIDAD"]
        };

        function startMission(missionNumber) {
            document.querySelectorAll('main > section').forEach(section => {
                section.classList.add('hidden');
            });
            
            document.getElementById(`mission${missionNumber}`).classList.remove('hidden');
            
            const progressFill = document.getElementById('progress-fill');
            if (missionNumber === 1) {
                progressFill.style.width = '35%';
            } else if (missionNumber === 2) {
                progressFill.style.width = '65%';
                initMission2();
            } else if (missionNumber === 3) {
                progressFill.style.width = '95%';
                initMission3();
            }
            
            if (missionNumber === 1 && !document.getElementById('quiz-questions').innerHTML) {
                initQuiz();
            }
            
            if (missionNumber === 1 && !document.getElementById('puzzle-pieces-container').innerHTML) {
                initPuzzle();
            }
        }
        
        function completeAdventure() {
            document.getElementById('mission3').classList.add('hidden');
            document.getElementById('final').classList.remove('hidden');
            
            document.getElementById('progress-fill').style.width = '100%';
            addPoints(50);
            
            createConfetti();
        }
        
        function createConfetti() {
            const container = document.getElementById('final');
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                confetti.style.width = (Math.random() * 10 + 5) + 'px';
                confetti.style.height = (Math.random() * 10 + 5) + 'px';
                container.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }
        
        function showMetacognition() {
            document.getElementById('final').classList.add('hidden');
            document.getElementById('metacognition').classList.remove('hidden');
        }
        
        function showAdminPanel() {
            document.querySelectorAll('main > section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById('admin-panel').classList.remove('hidden');
            renderStudentsList();
        }
        
        function logout() {
            document.getElementById('user-menu-dropdown').classList.add('hidden');
            document.querySelectorAll('main > section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById('welcome').classList.remove('hidden');
            document.getElementById('progress-fill').style.width = '35%';
        }
        
        function initQuiz() {
            const container = document.getElementById('quiz-questions');
            container.innerHTML = '';
            
            appState.quizData.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'bg-gray-100 p-4 rounded-lg';
                questionDiv.innerHTML = `
                    <h4 class="font-bold mb-2">Pregunta ${index+1}/${appState.quizData.length}: ${q.question}</h4>
                    <div class="space-y-2">
                        ${q.options.map((opt, optIndex) => `
                            <div class="flex items-center">
                                <input type="radio" name="quiz${index}" id="q${index}a${optIndex}" class="mr-2" value="${optIndex}">
                                <label for="q${index}a${optIndex}">${opt}</label>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }
        
        function initPuzzle() {
            const piecesContainer = document.getElementById('puzzle-pieces-container');
            const boardContainer = document.getElementById('puzzle-board');
            
            piecesContainer.innerHTML = '';
            boardContainer.innerHTML = '';
            
            for (let i = 1; i <= 9; i++) {
                const pieceDiv = document.createElement('div');
                pieceDiv.className = 'puzzle-piece bg-gray-200 rounded-lg aspect-square flex items-center justify-center text-xl font-bold cursor-move draggable';
                pieceDiv.textContent = i;
                pieceDiv.dataset.id = i;
                pieceDiv.draggable = true;
                
                pieceDiv.addEventListener('dragstart', handleDragStart);
                piecesContainer.appendChild(pieceDiv);
            }
            
            for (let i = 1; i <= 9; i++) {
                const slotDiv = document.createElement('div');
                slotDiv.className = 'puzzle-slot rounded-lg aspect-square';
                slotDiv.dataset.id = i;
                slotDiv.addEventListener('dragover', handleDragOver);
                slotDiv.addEventListener('drop', handleDrop);
                slotDiv.addEventListener('dragenter', handleDragEnter);
                slotDiv.addEventListener('dragleave', handleDragLeave);
                boardContainer.appendChild(slotDiv);
            }
        }
        
        function initMission2() {
            const gridContainer = document.getElementById('mural-grid');
            gridContainer.innerHTML = '';
            
            appState.muralMessages.forEach(msg => {
                const msgDiv = document.createElement('div');
                msgDiv.className = 'bg-yellow-200 p-4 rounded-lg shadow';
                msgDiv.innerHTML = `
                    <p class="font-bold">${msg.text}</p>
                    <p class="text-sm">- ${msg.author}</p>
                    <div class="text-right mt-2">
                        <button class="delete-mural text-red-500 hover:text-red-700" data-id="${msg.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                gridContainer.appendChild(msgDiv);
            });
        }
        
        function initMission3() {
            const commitmentsContainer = document.getElementById('commitments-container');
            commitmentsContainer.innerHTML = '';
            
            appState.commitments.forEach(commitment => {
                const commitmentDiv = document.createElement('div');
                commitmentDiv.className = 'bg-white p-3 rounded-lg shadow';
                commitmentDiv.innerHTML = `
                    <p>${commitment.text}</p>
                    <div class="text-right mt-2">
                        <button class="edit-commitment text-blue-500 hover:text-blue-700 mr-2" data-id="${commitment.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="delete-commitment text-red-500 hover:text-red-700" data-id="${commitment.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                commitmentsContainer.appendChild(commitmentDiv);
            });
            
            initWordSearch();
        }
        
        function initWordSearch() {
            const wordList = document.getElementById('word-list');
            const table = document.getElementById('word-search-table');
            
            wordList.innerHTML = '';
            table.innerHTML = '';
            
            appState.wordSearchWords.forEach(word => {
                const wordSpan = document.createElement('span');
                wordSpan.className = 'bg-peru-blue text-white px-3 py-1 rounded-full';
                wordSpan.textContent = word;
                wordList.appendChild(wordSpan);
            });
            
            const words = "RESPETOINCLUSIONDIVERSIDADIGUALDADSOLIDARIDAD";
            const letters = words.split('');
            
            for (let i = 0; i < 7; i++) {
                const row = document.createElement('tr');
                for (let j = 0; j < 10; j++) {
                    const index = i * 10 + j;
                    const cell = document.createElement('td');
                    cell.className = 'word-search-cell';
                    cell.textContent = index < letters.length ? letters[index] : String.fromCharCode(65 + Math.floor(Math.random() * 26));
                    row.appendChild(cell);
                }
                table.appendChild(row);
            }
        }
        
        function renderStudentsList() {
            const list = document.getElementById('students-list');
            list.innerHTML = '';
            
            appState.students.forEach(student => {
                const row = document.createElement('tr');
                row.className = 'border-b';
                row.innerHTML = `
                    <td class="py-2 px-4">${student.name}</td>
                    <td class="py-2 px-4">
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-peru-green h-2.5 rounded-full" style="width: ${student.progress}%"></div>
                        </div>
                        <span class="text-sm">${student.progress}%</span>
                    </td>
                    <td class="py-2 px-4">${student.points}</td>
                    <td class="py-2 px-4">
                        <button class="edit-student text-blue-500 hover:text-blue-700 mr-2" data-id="${student.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="delete-student text-red-500 hover:text-red-700" data-id="${student.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                list.appendChild(row);
            });
        }
        
        function addPoints(points) {
            appState.currentUser.points += points;
            document.getElementById('points-counter').textContent = appState.currentUser.points;
            
            const pointsCounter = document.getElementById('points-counter');
            pointsCounter.classList.add('success');
            setTimeout(() => {
                pointsCounter.classList.remove('success');
            }, 500);
        }
        
        function checkQuiz() {
            let correct = 0;
            
            appState.quizData.forEach((q, index) => {
                const selected = document.querySelector(`input[name="quiz${index}"]:checked`);
                if (selected && parseInt(selected.value) === q.correct) {
                    correct++;
                }
            });
            
            const result = document.getElementById('quiz-result');
            result.classList.remove('hidden');
            
            if (correct === appState.quizData.length) {
                result.textContent = `¡Perfecto! ${correct}/${appState.quizData.length} respuestas correctas (+20 puntos)`;
                result.className = "mt-4 font-bold text-lg text-green-600";
                addPoints(20);
            } else {
                result.textContent = `¡Buen intento! ${correct}/${appState.quizData.length} respuestas correctas. Sigue practicando.`;
                result.className = "mt-4 font-bold text-lg text-yellow-600";
                addPoints(5);
            }
        }
        
        function checkPuzzle() {
            const result = document.getElementById('puzzle-result');
            result.classList.remove('hidden');
            
            const placedPieces = document.querySelectorAll('#puzzle-board > div[draggable]').length;
            
            if (placedPieces >= 6) {
                result.textContent = '¡Felicidades! Rompecabezas completado correctamente (+15 puntos)';
                result.className = "mt-4 font-bold text-lg text-green-600";
                addPoints(15);
            } else {
                result.textContent = `Tienes ${placedPieces}/9 piezas colocadas. ¡Sigue intentando!`;
                result.className = "mt-4 font-bold text-lg text-yellow-600";
                document.getElementById('puzzle-board').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('puzzle-board').classList.remove('shake');
                }, 500);
            }
        }
        
        function checkRiddle() {
            const answer = document.getElementById('riddle-answer').value.toLowerCase();
            const result = document.getElementById('riddle-result');
            result.classList.remove('hidden');
            
            if (answer.includes('convivencia')) {
                result.textContent = '¡Correcto! La respuesta es "La Convivencia" (+10 puntos)';
                result.className = "mt-4 font-bold text-green-600";
                addPoints(10);
            } else {
                result.textContent = 'Intenta de nuevo. Pista: Tiene que ver con vivir juntos en armonía.';
                result.className = "mt-4 font-bold text-red-600";
            }
        }
        
        let draggedItem = null;

        function handleDragStart(e) {
            draggedItem = this;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', this.dataset.id);
            this.classList.add('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            return false;
        }
        
        function handleDragEnter(e) {
            this.classList.add('bg-peru-green', 'bg-opacity-30');
        }
        
        function handleDragLeave(e) {
            this.classList.remove('bg-peru-green', 'bg-opacity-30');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('bg-peru-green', 'bg-opacity-30');
            
            if (draggedItem) {
                this.appendChild(draggedItem);
                draggedItem.classList.remove('dragging');
                draggedItem = null;
            }
            
            return false;
        }
        
        function addMuralMessage() {
            const text = document.getElementById('mural-message').value;
            if (!text) return;
            
            const newMessage = {
                id: appState.muralMessages.length + 1,
                text: text,
                author: appState.currentUser.name
            };
            
            appState.muralMessages.push(newMessage);
            
            const gridContainer = document.getElementById('mural-grid');
            
            const msgDiv = document.createElement('div');
            msgDiv.className = 'bg-yellow-200 p-4 rounded-lg shadow';
            msgDiv.innerHTML = `
                <p class="font-bold">${text}</p>
                <p class="text-sm">- ${appState.currentUser.name}</p>
                <div class="text-right mt-2">
                    <button class="delete-mural text-red-500 hover:text-red-700" data-id="${newMessage.id}">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            gridContainer.appendChild(msgDiv);
            document.getElementById('mural-message').value = '';
            addPoints(5);
        }
        
        function deleteMuralMessage(id) {
            appState.muralMessages = appState.muralMessages.filter(msg => msg.id !== id);
            initMission2();
        }
        
        function addCommitment() {
            const text = document.getElementById('commitment-text').value;
            if (!text) return;
            
            const newCommitment = {
                id: appState.commitments.length + 1,
                text: text
            };
            
            appState.commitments.push(newCommitment);
            
            const commitmentDiv = document.createElement('div');
            commitmentDiv.className = 'bg-white p-3 rounded-lg shadow';
            commitmentDiv.innerHTML = `
                <p>${text}</p>
                <div class="text-right mt-2">
                    <button class="edit-commitment text-blue-500 hover:text-blue-700 mr-2" data-id="${newCommitment.id}">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="delete-commitment text-red-500 hover:text-red-700" data-id="${newCommitment.id}">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            document.getElementById('commitments-container').appendChild(commitmentDiv);
            document.getElementById('commitment-text').value = '';
            addPoints(5);
        }
        
        function editCommitment(id) {
            const commitment = appState.commitments.find(c => c.id === id);
            if (!commitment) return;
            
            const newText = prompt("Editar compromiso:", commitment.text);
            if (newText && newText.trim() !== '') {
                commitment.text = newText;
                initMission3();
            }
        }
        
        function deleteCommitment(id) {
            if (confirm("¿Estás seguro de eliminar este compromiso?")) {
                appState.commitments = appState.commitments.filter(c => c.id !== id);
                initMission3();
            }
        }
        
        function editStudent(id) {
            const student = appState.students.find(s => s.id === id);
            if (!student) return;
            
            const newName = prompt("Editar nombre del estudiante:", student.name);
            if (newName && newName.trim() !== '') {
                student.name = newName;
                renderStudentsList();
            }
        }
        
        function deleteStudent(id) {
            if (confirm("¿Estás seguro de eliminar este estudiante?")) {
                appState.students = appState.students.filter(s => s.id !== id);
                renderStudentsList();
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('user-menu').addEventListener('click', function() {
                document.getElementById('user-menu-dropdown').classList.toggle('hidden');
            });
            
            document.getElementById('check-riddle').addEventListener('click', checkRiddle);
            document.getElementById('riddle-answer').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') checkRiddle();
            });
            
            document.getElementById('video-complete').addEventListener('click', function() {
                this.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Completado';
                this.classList.remove('bg-peru-green');
                this.classList.add('bg-gray-400', 'cursor-not-allowed');
                this.disabled = true;
                addPoints(10);
            });
            
            document.getElementById('start-btn').addEventListener('click', function() {
                startMission(1);
            });
            
            document.getElementById('next-mission2').addEventListener('click', function() {
                startMission(2);
            });
            
            document.getElementById('next-mission3').addEventListener('click', function() {
                startMission(3);
            });
            
            document.getElementById('save-mission1').addEventListener('click', function() {
                alert('Misión 1 guardada con éxito!');
                addPoints(5);
            });
            
            document.getElementById('save-mission2').addEventListener('click', function() {
                alert('Misión 2 guardada con éxito!');
                addPoints(5);
            });
            
            document.getElementById('complete-adventure').addEventListener('click', completeAdventure);
            document.getElementById('show-metacognition').addEventListener('click', showMetacognition);
            document.getElementById('admin-btn').addEventListener('click', showAdminPanel);
            document.getElementById('logout-btn').addEventListener('click', logout);
            document.getElementById('profile-btn').addEventListener('click', function() {
                alert('Perfil del usuario');
            });
            
            document.getElementById('check-quiz').addEventListener('click', checkQuiz);
            document.getElementById('check-puzzle').addEventListener('click', checkPuzzle);
            document.getElementById('reset-puzzle').addEventListener('click', initPuzzle);
            document.getElementById('add-mural-message').addEventListener('click', addMuralMessage);
            document.getElementById('add-commitment').addEventListener('click', addCommitment);
            document.getElementById('add-student-btn').addEventListener('click', function() {
                const newName = prompt("Nombre del nuevo estudiante:");
                if (newName && newName.trim() !== '') {
                    const newStudent = {
                        id: appState.students.length + 1,
                        name: newName,
                        points: 0,
                        progress: 0
                    };
                    appState.students.push(newStudent);
                    renderStudentsList();
                }
            });
            
            document.addEventListener('click', function(e) {
                if (e.target.closest('.delete-mural')) {
                    const id = parseInt(e.target.closest('.delete-mural').dataset.id);
                    deleteMuralMessage(id);
                }
                
                if (e.target.closest('.delete-commitment')) {
                    const id = parseInt(e.target.closest('.delete-commitment').dataset.id);
                    deleteCommitment(id);
                }
                
                if (e.target.closest('.edit-commitment')) {
                    const id = parseInt(e.target.closest('.edit-commitment').dataset.id);
                    editCommitment(id);
                }
                
                if (e.target.closest('.delete-student')) {
                    const id = parseInt(e.target.closest('.delete-student').dataset.id);
                    deleteStudent(id);
                }
                
                if (e.target.closest('.edit-student')) {
                    const id = parseInt(e.target.closest('.edit-student').dataset.id);
                    editStudent(id);
                }
                
                if (!document.getElementById('user-menu').contains(e.target) && 
                    !document.getElementById('user-menu-dropdown').contains(e.target)) {
                    document.getElementById('user-menu-dropdown').classList.add('hidden');
                }
            });
            
            initQuiz();
            initPuzzle();
        });
    </script>
</body>
</html>